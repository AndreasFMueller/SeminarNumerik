Die Differentialgleichung $y'=e^y$ soll für die Anfangsbedingung $y(0)=0$
gelöst werden.
\begin{teilaufgaben}
\item
Berechnen Sie $y(0)$, indem Sie $2^k$ Eulerschritte der Länge $h=2^{-k}$ 
durchführen mit $k=0,1,2$.
\item
Berechnen Sie $y(0)$, indem Sie $2^k$ verbesserte Eulerschritte der Länge
$h=2^{-k}$ machen mit $k=0,1$.
\item
Finden Sie die exakte Lösung der Differentialgleichung.
Was passiert für $x\to 1$?
\item
Verwenden Sie ein Bibliotheksfunktion zur Berechnung der Werte $y(x)$ für
$x=1-10^{-k}$.
\end{teilaufgaben}

\begin{loesung}
\begin{teilaufgaben}
\item
Mit einem einzigen Eulerschritt der Länge $1$ erhält man
\[
y(1)
=
y(0) + h\cdot e^0
=
y(0) + 1\cdot 1 = 1.
\]
Mit Schritten der Länge $h=\frac12$ bekommt man
\begin{align*}
y({\textstyle \frac12})
&=
y(0) + \frac12 e^0 = \frac12
\\
y(1)
&=
y({\textstyle\frac12})
+\frac12\cdot e^y({\textstyle\frac12})
=
\frac12+\frac12e^{\frac12}
=
1.32436063535006407342
\end{align*}
Schliesslich für Schrittweite $h=0.25$
\begin{align*}
y(0.25) &= y(0.00) + 0.25 \cdot e^{y(0.00)} = 0.25
\\
y(0.50) &= y(0.25) + 0.25 \cdot e^{y(0.25)} = 0.57100635417193537101
\\
y(0.75) &= y(0.50) + 0.25 \cdot e^{y(0.50)} = 1.01351821668782980596
\\
y(1.00) &= y(0.75) + 0.25 \cdot e^{y(0.75)} = 1.70233762833485178875
\end{align*}
Es sind keine Anzeichen von Konvergenz sichtbar.
In der Tat kann man diese Analyse numerisch auch noch etwas weiter treiben,
man findet die Zahlen in Tabelle~\ref{5002:tabelle}
\begin{table}
\centering
\begin{tabular}{|>{$}r<{$}|>{$}l<{$}|>{$}l<{$}|>{$}l<{$}|}
\hline
k&\text{Euler-Verfahren}&\text{Euler verbessert}&\text{Runge-Kutta vereinfacht}\\
\hline
00 &   1.0000000000000000 &  \phantom{0}1.6487212707001282 &   \phantom{0}1.8591409142295225 \\
01 &   1.3243606353500641 &  \phantom{0}2.1699841098945125 &   \phantom{0}2.4250585225257479 \\
02 &   1.7023376283348517 &  \phantom{0}2.7597420811188282 &   \phantom{0}3.0490819078103311 \\
03 &   2.1276552548727867 &  \phantom{0}3.3956034434828641 &   \phantom{0}3.7069361001565753 \\
04 &   2.5925341403208058 &  \phantom{0}4.0585581421638404 &   \phantom{0}4.3824437828360674 \\
05 &   3.0894270605253125 &  \phantom{0}4.7362072763649881 &   \phantom{0}5.0668066827320546 \\
06 &   3.6119224240178083 &  \phantom{0}5.4215037321073574 &   \phantom{0}5.7555754708745690 \\
07 &   4.1549277159000182 &  \phantom{0}6.1107000131742213 &   \phantom{0}6.4465375423811189 \\
08 &   4.7145114453291557 &  \phantom{0}6.8018653488708489 &   \phantom{0}7.1385932738704421 \\
09 &   5.2876588211210143 &  \phantom{0}7.4940200070686585 &   \phantom{0}7.8311950168627185 \\
10 &   5.8720473151803398 &  \phantom{0}8.1866705263331685 &   \phantom{0}8.5240695517155327 \\
11 &   6.4658695535809256 &  \phantom{0}8.8795692762034442 &   \phantom{0}9.2170804278539613 \\
12 &   7.0677015640022800 &  \phantom{0}9.5725922163960995 &   \phantom{0}9.9101594608469572 \\
13 &   7.6764068630174913 &  10.2656772705460515 &  10.6032725687239502 \\
\hline
\end{tabular}
\caption{Näherungswerte für $y(1)$ für die Differentialgleichung 
$y'=e^y$ mit Euler-Schritten der Länge $2^{-k}$.
Es sind keine Anzeichen von Konvergenz sichtbar.
\label{5002:tabelle}}
\end{table}
\item
Ein verbesserter Eulerschritt besteht in einem halben Eulerschritt
zur Ermittellung der Steigung, mit der der Eulerschritt ausgeführt
werden soll:
\[
y_{i+1}
=
y_{i} + hf\biggl(x_i+\frac{h}2, y_i + \frac{h}2 f(x_i,y_i)\biggr)
=
y_i + he^{y_i + he^{y_i}/2}
\]
Die analoge Rechnung zu a) liefert die Zahlenwerte in Spalte 3 von
Tabelle~\ref{5002:tabelle}.
Auch in diesem Verfahren ist keine Konvergenz erkennbar.
\item
Die Differentialgleichung kann separiert werden:
\[
\int e^{-y}\, dy = \int 1\,dx
\quad\Rightarrow\quad
-e^{-y} = x + C
\]
Zum Auflösen nach $y$ geht man wie folgt vor
\begin{align*}
e^{-y} &= -C - x 
\\
-y &= \log (-C-x)
\\
y &= -\log (-C-x)
\end{align*}
Die Konstante $C$ muss etzt so gewählt werden, dass $-\log(-C) = 0$
ergibt, oder $-C = e^0=1$.
Damit ist die Lösung
$
y(x) = -\log(1-x).
$
Für $x\to 1$ divergiert $y(x)$ gegen $\infty$, so dass die fehlende 
Konvergenz der numerischen Verfahren nicht mehr überrascht.
\item
\begin{table}
\centering
\begin{tabular}{|>{$}c<{$}|>{$}l<{$}|>{$}r<{$}|>{$}r<{$}|}
\hline
k& x &\text{numerische Lösung}&-\log(1-x)\\
\hline
0 & 0.0000000 & \underline{ 0.000000000000000} &  0.000000000000000 \\
1 & 0.9000000 & \underline{ 2.30258}9125438244 &  2.302585092994046 \\
2 & 0.9900000 & \underline{ 4.605}219624234440 &  4.605170185988091 \\
3 & 0.9990000 & \underline{ 6.90}8262594576252 &  6.907755278982136 \\
4 & 0.9999000 & \underline{ 9.21}5442117286264 &  9.210340371976294 \\
5 & 0.9999900 & \underline{11.5}65174615733303 & 11.512925464974780 \\
6 & 0.9999990 & \underline{1}4.527024809503091 & 13.815510557935518 \\
\hline
\end{tabular}
\caption{Numerische und exakte Lösung der Differentialgleichung 
$y'=e^y$ für $x$-Werte $1-10^{-k}$. 
Die Divergenz der Lösung $y(x)$ für $x\to 1$ äussert sich in der
tatsache, dass das numerische Verfahren (die Funktion \texttt{lsode}
von Octave) keine konvergente Lösung nahe bei $1$ finden kann.
\label{5002:vergleich}}
\end{table}
Tabelle~\ref{5002:vergleich} zeigt die Resultate der numersichen
Rechnung im Vergleich mit der exakten Lösung.
Je näher $x$ bei $1$ liegt, desto schlechter wird die Genauigkeit
der numerischen Lösung.
\end{teilaufgaben}
\medskip

Die Differentialgleichung hat Lösungen, die nichts mit Singularitäten
der Differentialgleichungen zu tun haben.
Die Position der Singularität der Lösung hängt von den Anfangswerten
ab, sie kann also nur durch exakte Lösung vorhergesagt werden.
Die Aufgabe illustriert daher die Schwierigkeiten, die sich stellen,
wenn die Lösungen einer Differentialgleichung divergieren.
\end{loesung}

