%
% kont.tex -- Kontinuitätsgleichung mit FVM
%
% (c) 2020 Prof Dr Andreas Müller, Hochschule Rapperswil
%
\documentclass[tikz]{standalone}
\usepackage{amsmath}
\usepackage{times}
\usepackage{txfonts}
\usepackage{pgfplots}
\usepackage{csvsimple}
\usetikzlibrary{arrows,intersections,math}
\begin{document}
\def\skala{2}
\begin{tikzpicture}[>=latex,thick,scale=\skala]

\def\sx{1.4}
\def\sy{1.1}

\draw[->] ({-0.9*\sx},{0*\sy})--({3.9*\sx},{0*\sy}) coordinate[label={$x$}];
\draw[->] ({0*\sx},{-0.9*\sy})--({0*\sx},{1.9*\sy}) coordinate[label={left:$t$}];

\fill[color=blue!10] ({1*\sx},{0*\sy}) rectangle ({2*\sx},{1*\sy});
\foreach \x in {-1,...,3}{
	\foreach \y in {-1,...,1}{
		\node at ({(\x+0.5)*\sx},{(\y+0.5)*\sy}) {$V_{\x,\y}$};
	}
}

\foreach \x in {0,...,3}{
	\draw[line width=0.2pt] ({\x*\sx},{-0.8*\sy}) -- ({\x*\sx},{1.8*\sy});
	\foreach \y in {-0.5,0.5,1.5}{
		\fill[color=red] ({\x*\sx},{\y*\sy}) circle[radius=0.04];
	}
}
\foreach \y in {0,1}{
	\draw[line width=0.2pt] ({-0.8*\sx},{\y*\sy}) -- ({3.8*\sx},{\y*\sy});
	\foreach \x in {-0.5,0.5,...,3.5}{
		\fill[color=blue] ({\x*\sx},{\y*\sy}) circle[radius=0.04];
	}
}

\draw[color=red,line width=1.4pt] ({1*\sx},{0*\sy}) -- ({1*\sx},{1*\sy});
\draw[color=red,line width=1.4pt] ({2*\sx},{0*\sy}) -- ({2*\sx},{1*\sy});

\draw[color=blue,line width=1.4pt] ({1*\sx},{0*\sy}) -- ({2*\sx},{0*\sy});
\draw[color=blue,line width=1.4pt] ({1*\sx},{1*\sy}) -- ({2*\sx},{1*\sy});

\definecolor{pink}{rgb}{1,0.4,1}
\fill[color=pink]
	({1*\sx-0.013},{0*\sy-0.013}) rectangle ({1*\sx+0.013},{0*\sy+0.013});
\fill[color=pink]
	({1*\sx-0.013},{1*\sy-0.013}) rectangle ({1*\sx+0.013},{1*\sy+0.013});
\fill[color=pink]
	({2*\sx-0.013},{0*\sy-0.013}) rectangle ({2*\sx+0.013},{0*\sy+0.013});
\fill[color=pink]
	({2*\sx-0.013},{1*\sy-0.013}) rectangle ({2*\sx+0.013},{1*\sy+0.013});

\foreach \x in {-1,...,3}{
	\node[color=blue] at ({(\x+0.5)*\sx},\sy) [above] {$m_{\x,1}\mathstrut$};
	\node[color=blue] at ({(\x+0.5)*\sx},0) [below] {$m_{\x,0}\mathstrut$};
}

\foreach \y in {-1,0,1}{
	\foreach \x in {0,1}{
		\node[color=red] at ({\x*\sx},{(\y+0.5)*\sy})
			[left] {$j_{\x,\y}\mathstrut$};
		\node[color=red] at ({\x*\sx},{(\y+0.5)*\sy})
			[left] {$j_{\x,\y}\mathstrut$};
	}
	\foreach \x in {2,3}{
		\node[color=red] at ({\x*\sx},{(\y+0.5)*\sy})
			[right] {$j_{\x\y}\mathstrut$};
		\node[color=red] at ({\x*\sx},{(\y+0.5)*\sy})
			[right] {$j_{\x\y}\mathstrut$};
	}
}

\draw[<->,line width=0.2pt]
	({0*\sx},{-0.75*\sy}) -- ({1*\sx},{-0.75*\sy});
\node at ({0.5*\sx},{-0.75*\sy}) [below] {$h_x$};
\draw[<->,line width=0.2pt]
	({-0.75*\sx},{0*\sy}) -- ({-0.75*\sx},{1*\sy});
\node at ({-0.75*\sx},{0.5*\sy}) [left] {$h_t$};

\end{tikzpicture}
\end{document}

