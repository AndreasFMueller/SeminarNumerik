%
% loesung.tex -- Beispiel-File für die Beschreibung der Loesung
%
% (c) 2020 Prof Dr Andreas Müller, Hochschule Rapperswil
%
\section{Anwendungen
\label{pade:section:Anwendungen}}
\rhead{Anwendungen}

In diesem Abschnitt werden ein paar Anwendungsmöglichkeiten der Padé-Approximation gezeigt.
Wie in der Signalverarbeitung in der Elektrotechnik üblich, werden des öfteren mathematische Probleme im Frequenzbereich gelöst, da dies oft einfacher ist. 
\index{Signalverarbeitung}%
\index{Frequenzbereich}%
\index{Zeitbereich}%
Die Transformation in das geeignete Spektrum kann bei kontinuierlichen Signalen mit der Laplace-Transformation und bei diskreten Signalen mit der Z-Transformation erreicht werden.
Unter dem Begriff Übertragungsfunktion, versteht man das Verhältnis von Ausgangssignal zu Eingangssignal.
Die Abhängigkeit der verschiedenen Zustandsräumen wird
in Abbildung~\ref{pade:zeitundspektral}
mit dem Beispiel der Übertragungsfunktion $h(t)$ dargestellt.
\begin{figure}
\centering
	\tikzset{>=latex}
\begin{tikzpicture}
\node[draw,text width=4cm,minimum height=2.5cm,align=center] at (0,0) {Signale im kontinuierlichen Zeitbereich $h(t)$};
\node[draw,text width=4cm,minimum height=2.5cm,align=center] at (0,-4) {Signale im diskreten Zeitbereich $h(n)$};
\node[draw,text width=4cm,minimum height=2.5cm,align=center] at (9,0) {Spektralbereich, Laplace-Bildbereich $H(s)$};
\node[draw,text width=4cm,minimum height=2.5cm,align=center] at (9,-4) {Spektralbereich, Z-Bildbereich $H(z)$};

\draw[thick,->] (2.12,0)--(6.88,0);
\draw[thick,->] (2.12,-4)--(6.88,-4);
\draw[thick,->] (0,-1.25)--(0,-2.75);

\node[text width=4cm,minimum height=2.5cm,align=center] at (4.5,-0.5) {Laplace-Transformation};
\node[text width=4cm,minimum height=2.5cm,align=center] at (2,-2) {Abtasten/Diskretisieren};
\node[text width=4cm,minimum height=2.5cm,align=center] at (4.5,-4.5) {Z-Transformation};
\end{tikzpicture}
\caption{Zeit- und Spektralbereich für stetige und diskrete Signale
\label{pade:zeitundspektral}}
\end{figure}
Dabei gelten $s= \sigma+ j\omega$ und $z = A e^{j\omega} =\sigma+ j\omega$.
Der jeweilige Spektralbereich wird auch oft Bildbereich genannt.

\subsection{Totzeit Approximation
\label{pade:subsection:totzeit}}
\index{Totzeit}%
\index{Verzögerung}%
\index{LZI}%
\index{Linear zeitinvariantes System}%
\index{System, linear-zeitinvariantes}%
Bei der Totzeit spricht man von einer Verzögerung im Zeitbereich, welche zum Beispiel in einem digitalen Regelkreis vorkommen kann.
Lineare zeitinvariante (LZI)-Systeme oder besser bekannt unter dem englischen Begriff linear time-invariant (LTI) system, sind unabhängig von zeitlichen Verschiebungen. 
\index{LTI}%
\index{linear time-invariant system}%
\index{system, linear time-invariant}%
Die Eingangs-Ausgangsbeziehung von LTI-Systemen, ist durch die
zeitdiskrete Faltung der Impulsantwort des Systems mit dem
Eingangssignal gegeben.
LTI-Systeme können in zwei Typen  eingeteilt werden.
Der erste Typ ist die finite impulse response (FIR) mit endlicher Impulsantwort.
\index{FIR}%
\index{Finite impulse response}%
\index{endliche Impulsantwort}%
\index{Impulsantwort, endliche}%
Typ~2 hat eine unendlich lange Impulsantwort, genannt die infinite impulse response (IIR).
\index{inifinite impulse response}%
\index{IIR}%
\index{impulse reponse!fininite}%
\index{impulse reponse!infininite}%
Diese zwei Typen unterteilen Impulsantworten anhand der Eigenschaft ob sie eine endliche oder unendliche Dauer hat. 
Wer sich mit LTI Systemen auseinander gesetzt hat, weiss, dass eine Totzeit $T$ im Frequenzbereich durch eine Exponentialfunktion
\begin{equation*}
H(s) = e^{-sT}
\end{equation*}
ausgedrückt wird.

Verschiedene Methoden wie z.B. die Wurzelortskurven können nicht mit einer Totzeit umgehen, sondern nur mit Übertragungsfunktionen, welche normalerweise als gebrochen rationale Funktionen vorliegen.
Die Übertragungsfunktion besteht aus einem Nenner- und Zählerpolynom
welches der Form
\begin{equation*}
H(s)=\frac{P(s)}{Q(s)}
\end{equation*}
entspricht.
Wir bezeichnen die Grade von $P(s)$ und $Q(s)$ mit $p$ und $q$.

Beim Design von Filtern, Reglern oder anderen frequenzabhängigen Netzwerken, verwendet man die Laplace- oder Z-Transformierte der Übertragungsfunktion, um die Eigenschaften des zu entwerfenden Netzwerkes zu synthetisieren oder zu analysieren.
\index{Laplace-Transformation}%
\index{Z-Transformation}%
Dazu benötigt man nun die Übertragungsfunktion in Form von gebrochenen
Polynomen, mit welchen man zum Beispiel die Pol- und Nullstellen
des Netzwerkes erkennt.
Mit diesen Pol- und Nullstellen können Aussagen über den Betrags-
und Phasenverlauf des Frequenzgangs, Impuls- und Sprungantwort,
Stabilität eines Systems und weitere Eigenschaften gemacht werden.
\index{Phasenverlauf}%
\index{Frequenzgang}%
\index{Sprungantwort}%
\index{Impulsantwort}%
\index{Stabilität}%
Mit diesen Informationen kann entschieden werden, welche Parameter geändert werden müssen um die gewünschten Eigenschaften zu erhalten.
 
Diese Netzwerke werden oft mit passiven Bauelementen wie Widerständen, Induktivitäten und Kapazitäten und einem Operationsverstärker realisiert.
\index{Netzwerk}%
\index{Widerstand}%
\index{Induktivität}%
\index{Kapazität}%
\index{Operationsverstärker}%
Ein PID-Glied kann so zum Beispiel in vereinfachter Form wie in
\index{PID-Glied}%
Abbildung~\ref{pade:pid-circuit} konstruiert werden.
\begin{figure}
\centering
%	\tikzset{>=latex}
%\begin{tikzpicture}
%\node[text width=4cm,minimum height=2.5cm,align=center] at (0,0.25) {Input};
%\node[text width=4cm,minimum height=2.5cm,align=center] at (8.5,-0.25) {Output};
%\node at (2,0.5) {$R_1$};
%\node at (5.5,2) {$R_2$};
%
%\node at (2,-1.25) {$C_1$};
%\node at (4.1,1.25) {$C_2$};
%
%\draw[thick] (0,0)--(1,0)--(1,0.5)--(1,-0.5);
%\draw[thick] (1,-0.5)--(1.9,-0.5)--(1.9,0)--(1.9,-1);
%\draw[thick] (2.1,-1)--(2.1,0)--(2.1, -0.5)--(3,-0.5)--(3,0.5)--(2.5,0.5)--(3,0.5)--(3,0)--(3.5,0)--(3.5,2)--(4,2)--(4,1.5)--(4,2.5);
%\draw[thick](4.2,2.5)--(4.2,1.5)--(4.2,2)--(5,2);
%\draw[thick] (1,0.5)--(1.5,0.5);
%\draw[thick] (6,2)--(7.5,2)--(7.5,-0.5)--(4+2.59808,-0.5)--(9,-0.5);
%
%\draw[draw=black,thick] (1.5,0.25) rectangle ++(1,0.5);
%\draw[draw=black,thick] (5,1.75) rectangle ++(1,0.5);
%
%\draw[thick] (3.5,0)--(4,0)--(4,1)--(4+2.59808,-0.5)--(4,-2)--(4,1);
%\draw[thick] (4,-1)--(3,-1)--(3,-3)--(2.5,-3)--(3.5,-3);
%\draw[thick] (4.2,-1)--(4.4,-1);
%\draw[thick] (4.3,-0.9)--(4.3,-1.1);
%\draw[thick] (4.2,0)--(4.4,0);
%\end{tikzpicture}
\includegraphics{papers/pade/pid.pdf}
\caption{Realisierung eines PID-Gliedes mit Operationsverstärker,
Widerständen und Kapazitäten.
\label{pade:pid-circuit}}
\end{figure}
Zu diesem Beispiel können nun die dazugehörigen Eingangs- und
Ausgangsimpedanzen
\index{Eingangsimpedanz}%
\index{Ausgangsimpedanz}%
\index{Impedanz}%
\begin{equation*}
Z_{0}(s)
=
\frac{1+s C_{2} R_{2}}{s C_{2}}
\end{equation*}
\begin{equation*}
Z_{1}(s)
=
\frac{R_{1}}{1+s C_{1} R_{1}}
\end{equation*}
berechnet werden.
Für die Übertragungsfunktion erhält man damit
\index{Übertragungsfunktion}%
\begin{equation*}
H(s)
=
\frac{Z_{0}(s)}{Z_{1}(s)}
=
\frac{1-C_2 R_2 C_1 R_1+ s C_2 R_2 +s C_1 R_1 }{s C_2 R_2}.
\end{equation*}
Die zwei Polstellen befinden sich somit bei $s=0$ was einem DC entsprechen würde.
Die Nullstellen befinden sich bei
\begin{equation*}
s
=
\frac{C_1 R_1 C_2 R_2 -1}{C_1 R_1 + C_2 R_2},
\end{equation*}
abhängig von den Komponenten.
Die Erkenntnisse kann man nun für die Dimensionierung der Bauteile
oder für Aussagen darbüber verwenden, für welche Anwendungen dieses PID-Glied
nicht geeignet ist.

Leider kann mit einem passiven Bauteil keine Exponentialfunktion im Frequenzbereich nachgebaut werden und somit auch keine Totzeit.
In der Praxis wird deshalb die Totzeit oft mit digitalen Bausteinen realisiert, da man digital einfach die Werte speichern kann und zur gewünschten Zeit wieder ausgeben.
Mit $e^{-sT}$ in einem analogen System haben wir jedoch keine brauchbaren Pol- Nullstellen welche mit passiven Bauteilen nachgebaut werden können.  
Dies kann jedoch gefordert sein wenn man eine zeit-kontinuierliche Analyse macht oder einfach keine Digitalbausteine in seiner Schaltung verwenden will.
Eine Lösung dafür könnte nun sein, $e^{-sT}$ zu approximieren und die Approximation für weitere Rechnungen zu verwenden.

Die Padé-Approximation der Exponentialfunktion ist glücklicherweise schon bekannt und kann mit den Formeln \eqref{pade:expP} und \eqref{pade:expQ} für eine beliebig hohe Ordnung ermittelt werden.
Die Qualität dieser Approximation wird ersichtlich, wenn die Padé-Approximanten in einer logarithmischen Skala mit der originalen Funktion vergleichen.
In der Grafik \ref{pade:totzeitexp} zeigt sich, dass die Padé-Approximation mit steigendem Grad bessere Resultate liefert und sich der Exponentialfunktion mehr und mehr annähert.

\begin{figure}
\centering
\begin{tikzpicture}[>=latex]
\clip (-7,-4.6) rectangle (7,3.9);
\node at (0,0) {
\includegraphics[width=1.2\linewidth]{./papers/pade/python/bilder/totzeit.pdf}
};
\end{tikzpicture}
\caption{Plot der Padé-Approximanten der Exponentialfunktion
im Vergleich zu der Originalfunktion in einer logarithmischen
Skala vergleichend mit der Taylor-Polynom sechster Ordnung
der Exponentialfunktion.
\label{pade:totzeitexp}}
\end{figure}

Im Beispiel \ref{pade:totzeitexp} mit der Exponentialfunktion erweisen sich die Padé-Approximanten des selben Grades im Nenner und Zähler als die genauesten Approximationen.
Es wird dabei mit steigendem Grad der Approximation eine stetige Verbesserung erzielt.
Zum Vergleich ist noch das Taylor-Polynom sechster Ordnung von $e^{-x}$
in der Grafik \ref{pade:totzeitexp} dargestellt. 
Diese ist im negativen Bereich der Funktionsachse deutlich schlechter als die Padé-Approximanten, jedoch verhält sie sich im positiven Bereich besser.

\begin{figure}
\centering
\begin{tikzpicture}[>=latex]
\clip (-3.0,-4.0) rectangle (3.0,3.7);
\node at (0,0) {
\includegraphics[width=0.50\linewidth]{./papers/pade/python/bilder/poles1.pdf}
};
\end{tikzpicture}
\caption{Pol- und Nullstellen in der komplexen Ebene wenn $p=q$ ist.
\label{pade:poles1}}
\end{figure}
%
\begin{figure}
\centering
\begin{tikzpicture}[>=latex]
\begin{scope}[xshift=-3.5cm]
\clip (-3.0,-4.0) rectangle (3.0,3.7);
\node at (0,0) {
\includegraphics[width=0.50\linewidth]{./papers/pade/python/bilder/poles2.pdf}
};
\end{scope}
\begin{scope}[xshift=3.5cm]
\clip (-3.3,-4.0) rectangle (3.0,3.7);
\node at (0,0) {
\includegraphics[width=0.50\linewidth]{./papers/pade/python/bilder/poles3.pdf}
};
\end{scope}
\end{tikzpicture}
\caption{Pol- und Nullstellen in der komplexen Ebene wenn $p<q$ (links)
und $p>q$ (rechts) ist.
\label{pade:poles2}}
\end{figure}
%
\begin{figure}
\centering
\begin{tikzpicture}[>=latex]
\clip (-7,-4.6) rectangle (7,3.9);
\node at (0,0) {
\includegraphics[width=1.2\linewidth]{./papers/pade/python/bilder/padehigh1.pdf}
};
\end{tikzpicture}
\caption{Rücktransformation der Padé-Approximanten im Zeitbereich geplottet
wenn $p=q$ ist.\label{pade:totzeit1}}
\end{figure}
%
\begin{figure}
\centering
\begin{tikzpicture}[>=latex]
\clip (-7,-4.6) rectangle (7,3.9);
\node at (0,0) {
\includegraphics[width=1.2\linewidth]{./papers/pade/python/bilder/padehigh2.pdf}
};
\end{tikzpicture}
\caption{Rücktransformation der Padé-Approximanten im Zeitbereich geplottet
wenn $p=q-10$ ist.\label{pade:totzeit2}}
\end{figure}

Transformieren wir nun diese gebrochenen Polynome, welche sich noch
im Frequenzbereich befinden zurück in den Zeitbereich, erhalten wir
die in der Grafik \ref{pade:totzeitexp2} dargestellten Kurven.
\begin{figure}
\centering
\begin{tikzpicture}[>=latex]
\clip (-7,-4.6) rectangle (7,3.9);
\node at (0,0) {
\includegraphics[width=1.2\linewidth]{./papers/pade/python/bilder/padelow33.pdf}
};
\end{tikzpicture}
\caption{In den Zeitbereich rücktransformierte Padé-Approximanten tieferer Ordnungen\label{pade:totzeitexp2}.}
\end{figure}
Die Polynome der Ordnung $[3/3]$ sind dabei noch weit von einem brauchbaren Ergebnis des gesuchten verzögerten Einheitssprunges entfernt.
Man kann nun die Ordnung der Padé-Approximanten weiter erhöhen bis eine zufriedenstellende Approximation vorliegt.
Dabei muss jedoch aufgepasst werden, welche Methode für die
Rücktransformation verwendet wird.
Nicht alle Implementationen der Rücktransformation von Übertragungsfunktionen in ein Zustandsraummodell sind numerisch stabil. 
Bei Polynomen grosser Ordnung oder wenn das Nenner- und Zähler- Polynom nicht gleicher Ordnung sind, können bei einer Rücktransformation Fehler auftauchen.
Dies ist jedoch ein anderes Thema, welches den Rahmen dieses Papers sprengen würde.

In den Abbildungen \ref{pade:poles1} und \ref{pade:poles2}
sind nun die Pol- und Nullstellen von höheren Ordnungen dargestellt. 
Auffallend ist die schöne Symmetrie der Pol- und Nullstellen, welche
bei gleicher Ordnung der Nenner- und Zählerpolynome um den Nullpunkt
verteilt sind.
Diese Symmetrie verschwindet wenn der Grad des Nenner- oder des
Zählerpolynoms grösser gewählt wird.
Dies kann man soweit treiben, bis eine Polstelle in den rechten
Bereich der komplexen Halbebenen reicht \ref{pade:poles2},
was ein instabiles System zur Folge hat.
Ein instabiles System beutetet hier, dass der rücktransformierte
Einheitssprung eine anwachsende Schwingung ist.

Verwendet man nun die Approximanten höherer und gleicher Ordnung
für die Rücktransformation in Grafik \ref{pade:totzeit1}, erhält
man einen immer besser werdenden Einheitssprung mit einem kleinen
Überschwinger vor und nach dem Sprung.
Auffallend ist hier, dass der Padé-Approximant höchster Ordnung zu
Beginn den grössten Fehlerpeak hat.
Dieser ist sogar so hoch wie der Einheitssprung selbst.
\index{Fehlerpeak}%

Um diesen Fehlerpeak zu Beginn ein wenig zu vermindern, können nun die Pole in der komplexen Ebene ein wenig näher zur positiven Halbebene gebracht werden.
Wie schon in  dem Pol- Nullstellendiagramm \ref{pade:poles2} erkennbar, ist das mit einer Differenz von der Ordnung des Zählerpolynoms $p$ und Nennerpolynom $q$ möglich.
Mit einer Differenz von 190 zu 200 der Polynom Ordnung wurde die Rücktransformierte des Padé-Approximanten der Grafik \ref{pade:totzeit2} dargestellt.
Deutlich zu sehen ist dabei, dass der Überschwinger, welcher bei dem Padé-Approximanten gleicher Ordnung in derselben Grafik \ref{pade:totzeit2} noch vorhanden ist, verschwindet.
Jedoch besitzt der Approximant ungleicher Ordnung eine längere Einschwingzeit als der mit gleicher Ordnung. 
Mit diesen Werten der Ordnungen kann in der Praxis solange optimiert werden, bis man die beste Lösung für das gegebene Problem gefunden hat.

\FloatBarrier

\subsection{Digitale Signalmodellierung
	\label{pade:subsection:SignalMod}}

Das Ziel einer Signalmodellierung ist, eine parametrische Beschreibung eines Signales zu finden.
\index{Signalmodellierung}%
\index{Signal}%
Dies kann für die Filterentwicklung, Interpolation, Extrapolation oder Kompression verwendet werden.
\index{Filterentwicklung}%
\index{Interpolation}%
\index{Extrapolation}%
\index{Kompression}%
Beispielsweise soll ein Audiosignal $x(n)$, welches $N$ Werte
$[x(0),...,x(N-1)]$
lang ist,
soll gespeichert oder übertragen werden.
\index{Audiosignal}%
Eine Möglichkeit ist es das komplette diskrete Signal, in einem Übertragungskanal zu übertragen.
Wenn es jedoch möglich ist, dieses Signal mit einer kleineren Anzahl
$k$ von Parametern zu modellieren, wobei $k\ll N$, ist es effizienter,
diese Parameter zu senden statt das komplette diskrete Signal.

Als ein einfaches Beispiel kann ein Sinuston verwendet werden.
Das Audiosignal $x(n)$ wäre in diesem Fall $x(n)= a \cos(n\omega_0 + \phi)$.
Würde man nun dieses Signal speichern oder über einen Übertragungskanal versenden, und würde einfach alle Samples $x(n)$ verwenden, wäre dies sehr ineffizient.
Eine bessere Methode ist die Amplitude $a$, die Frequenz $\omega_0$ und die Phase $\phi$ aus dem Audiosignal zu messen und diese Parameter für die Speicherung oder Übertragung zu verwenden.
Mit diesen Parametern kann das Signal $x(n)$ später perfekt rekonstruiert werden.

Bei komplizierteren Signalen verwendet man einfach mehr Parameter.
\begin{equation}
x(n) \approx \sum_{k=1}^{L} a_{k} \cos \left(n \omega_{k}+\phi_{k}\right)
\end{equation}
Die dazugehörigen Modellparameter ($a_k,\omega_{k},\phi_{k},k=1,...,L$) können gemessen und übertragen werden.
Die Schwierigkeit ist ein gutes Verhältnis zwischen Effizient und Genauigkeit zu finden. 

In diesem Abschnitt verwenden wir immer das gleiche Modell, welches den Ausgang $x(n)$ eines linearen verschiebungsinvarianten Filters zu einem Eingang $v(n)$ darstellt.  
\begin{center}
\begin{tikzpicture}
\tikzset{>=latex}
\node at (-1,1.2)  {$v(n)$}; 
\draw[thick,->] (-2,1)--(0,1);
\draw[thick] (0,0) rectangle (3,2) node[pos=.5] {$H(z)=\displaystyle \frac{B_q (z)}{A_p (z)}$};
\draw[thick,->] (3,1)--(5,1);
\node at (4,1.2)  {$\hat{x}(n)$}; 
\end{tikzpicture}
\end{center}
Dieses Modell wird mit einer rationalen Funktion
\begin{equation}
H(z)
=
\frac{B_{q}(z)}{A_{p}(z)}
=
\frac{\displaystyle\sum_{k=0}^{q} b_{q}(k) z^{-k}}{1+\displaystyle\sum_{k=1}^{p} a_{p}(k) z^{-k}}
\label{pade:uebertragungsfunktion}
\end{equation}
beschrieben.
Der Fehler $e^{\prime}$ dieses Modells, ist durch die Differenz des originalen Signales und dem Ausgang des approximierenden Modells
\begin{equation}
e^{\prime}(n)=x(n)-\hat{x}(n)
\end{equation}
definiert. 
Das Ziel ist, einen Filter $H(z)$ und einen Input $v(n)$ zu finden, welche
$\hat{x}(n)$ so nahe wie möglich an $x(n)$ bringen.

Wenn man ein Modell gewählt hat, möchte man die besten Parameter oder auch die beste Approximation für sein Modell finden.
Es gibt jedoch sehr viele Arten, die beste Approximation zu definieren und damit auch unzählige Methoden um die Modellparameter zu erhalten.
Deshalb ist es wichtig, wenn man eine Signalmodellierung angeht,
eine Methode zu finden, welche nicht nur funktioniert und gute Werte
liefert, sondern auch effizient berechenbar ist.
Dies ist besonders bei Systemen zur Echtzeitdatenverarbeitung ausschlaggebend.
\index{Echtzeitdatenverarbeitung}%

Um eine solche Approximation zu finden ist die erste Intuition oft den Fehler minimieren zu wollen.
Dies nennt sich auch die Least Squares Methode.
\index{Least Squares}%
Ziel ist es dabei den quadratischen Fehler 
\index{quadratischer Fehler}%
\begin{equation}
E_{L S}
=
\sum_{n=0}^{\infty}\left|e^{\prime}(n)\right|^{2}
\end{equation}
des Systems zu minimieren.

Aus den Bedienungen der Least Squares Method resultiert eine Menge von nichtlinearen Gleichungen welche möglicherweise sehr schwierig lösbar sind.
Da die Lösungsverfahren, welche für die Lösung solcher Gleichungen
verwendet wird, wie die Newtonsche Methode und steepest descent, iterative
Methoden sind, sind diese rechnerisch sehr kostspielig und langsam.
Aus diesem Grund wird in der Praxis der Ansatz des kleinsten quadratischen Fehlers vermieden. 

Um diese nichtlinearen Gleichungen zu vermeiden und dennoch eine
Lösung zu finden, welche uns eine passende Anzahl von $x[n]$ Werten
mit der Einheitssprungantwort verbindet, kann ein eleganter Trick,
der zur Padé-Approximation führt verwendend werden.
Aus \eqref{pade:uebertragungsfunktion} bekommt man zunächst
\begin{equation}
H(z) A_{p}(z)=B_{q}(z).
\end{equation}
In der Zeitebene betrachtet handelt es sich in bei dieser Gleichung
um die Faltung
\begin{equation}
h(n)+\sum_{k=1}^{p} a_{p}(k) h(n-k)=b_{q}(n).
\end{equation}
Die rechte Seite der Gleichung für $n>q$ ist dabei gleich null.
Die Fallunterscheidung
\begin{equation}
x(n)+\sum_{k=1}^{p} a_{p}(k) x(n-k)
=
\begin{cases}
b_{q}(n) & 
\quad \text{mit } \quad n=0,1, \ldots, q \\
0 & 
\quad\text{mit } \quad n=q+1, \ldots, q+p
\end{cases}
\end{equation}
kann in die Matrixform 
\begin{equation}
\left[\begin{array}{cccc}
x(0) & 0 & \cdots & 0 \\
x(1) & x(0) & \cdots & 0 \\
x(2) & x(1) & \cdots & 0 \\
\vdots & \vdots & \ddots & \vdots \\
x(q) & x(q-1) & \cdots & x(q-p) \\
x(q+1) & x(q) & \cdots & x(q-p+1) \\
\vdots & \vdots &\ddots  & \vdots \\
x(q+p) & x(q+p-1) & \cdots & x(q)
\end{array}\right]
\left[\begin{array}{c}
1 \\
a_{p}(1) \\
a_{p}(2) \\
\vdots \\
a_{p}(p) \\
\end{array}\right]
=
\left[\begin{array}{c}
b_{q}(0) \\
b_{q}(1) \\
b_{q}(2) \\
\vdots \\
b_{q}(q) \\
0 \\
\vdots \\
0
\end{array}\right]
\end{equation}
gebracht werden.
Diese Matrix ist uns schon aus dem Abschnitt \ref{pade:subsection:Pade_erstellen} bekannt. Es handelt sich nämlich um eine Padé-Approximation,
welche wir nun für das Signal mit einer vorgegebener Ordnung berechnen können.

\begin{beispiel}

Die ersten sechs Werte 
\begin{equation*}
\bm x=\left[
\begin{array}{l}
1.0000\\
1.5000\\
0.7500\\
0.3750\\
0.1875 \\
0.0938
\end{array}\right]
\end{equation*}
eines Signales sind vorgegeben.
Das Ziel ist, drei verschiedene Padé-Approximanten mit drei verschiedenen
Freiheitsgraden zu finden.
Die Grade von Zähler und Nenner dieser Approximationen sind in der folgenden
Tabelle gegeben.
\begin{center}
\begin{tabular}{l|c|c}
Modell                         &Zählergrad $q$&Nennergrad $p$\\
\hline
all pole                       &            0 &            2 \\
finite impulse response (FIR)  &            2 &            0 \\
infinite impulse repones (IIR) &            1 &            1 \\
\hline
\end{tabular}
\end{center}
%\begin{equation*}\begin{aligned}
%&\begin{array}{ll}
%\text { All pole } & (q=0, p=2) \\
%\text { FIR } & (q=2, p=0)\\
%\text { IIR } &(\mathrm{q}=1, \mathrm{p}=1)
%\end{array}\\
%\end{aligned}\end{equation*}

\begin{enumerate}
\item Das {\em All pole} Modell $(q=0,p=2)$ wird in die Matrixform
\index{All pole model}%
\begin{equation}\left[\begin{array}{ccc}
x(0) & 0 & 0 \\
x(1) & x(0) & 0 \\
x(2) & x(1) & x(0)
\end{array}\right]\left[\begin{array}{c}
1 \\
a_1 \\
a_2
\end{array}\right]=\left[\begin{array}{c}
b_0 \\
0 \\
0
\end{array}\right]\end{equation}
gebracht. 
Von der ersten Gleichung folgt, dass der Wert $b_0 = x(0)=1$ ergeben muss. 
Weiter können nun die letzten zwei Gleichungen
\begin{equation}\left[\begin{array}{ll}
x(0) & 0 \\
x(1) & x(0)
\end{array}\right]\left[\begin{array}{l}
a_1 \\
a_2
\end{array}\right]=-\left[\begin{array}{l}
x(1) \\
x(2)
\end{array}\right]\end{equation}
eingesetzt und gelöst werden.
\begin{equation}\left[\begin{array}{cc}
1 & 0 \\
1.5 & 1
\end{array}\right]\left[\begin{array}{l}
a_1 \\
a_2
\end{array}\right]=-\left[\begin{array}{c}
1.50 \\
0.75
\end{array}\right]\end{equation}
Die resultierenden Koeffizienten
\begin{equation}
a_1=-1.50 \quad  \quad a_2=1.50
\end{equation}
können nun zusammen mit dem $b_0$-Koeffizienten in die Übertragungsfunktion  
eingesetzt werden.
Somit erhalten wir als Ergebnis für die Approximation unseres $x(n)$ 
\begin{equation}
H(z)=\frac{1}{1-1.50 z^{-1}+1.50 z^{-2}}.
\end{equation}

Man sollte beachten, dass sich die komplexen Pole nicht im Inneren des
Einheitskreises befinden und somit das Resultat kein stabiles Modell sein wird.
\index{stabil}%
\index{instabil}%
\index{Einheitskreis}%
Evaluiert man die Impulsantwort des Systems, erhalten wir die 
Approximation
\begin{equation}
\hat{x}=[1,1.500,0.750,-1.125,-2.8125,-2.5312].
\end{equation}
für $x(n)$.
Daraus geht hervor das $x(n)= \hat{x}$ für $n= 0,1,2$ gleich ist,
jedoch bei höheren $n$ keine genaue Approximation liefert.

\item Für das FIR-Modell $(q=2,P=0)$ ist das Resultat einfach mit
$A(z)=1$ berechenbar.
Da alle weiteren $a$-Koeffizienten wegfallen werden die $b$-Koeffizienten
mit dem Eingangsignal gleich gesetzt
\begin{equation}\begin{array}{r}
\left[\begin{array}{l}
	x(0) \\
	x(1) \\
	x(2)
\end{array}\right]
=
\left[\begin{array}{l}
	b_0 \\
	b_1 \\
	b_2
	\end{array}\right].
\end{array}\end{equation}

Somit erhalten wir 
\begin{equation}
H(z)=1+1.50 z^{-1}+0.75 z^{-2}
\end{equation}
als unser Modell.

\item Für das IIR-Modell mit $(q=1,p=1)$ welches die Form
\begin{equation}
H(z)=\frac{b(0)+b(1) z^{-1}}{1+a(1) z^{-1}}
\end{equation}
erhalten wird, sind die Padé-Gleichungen

\begin{equation}\left[\begin{array}{ll}
x(0) & 0 \\
x(1) & x(0) \\
x(2) & x(1)
\end{array}\right]\left[\begin{array}{c}
1 \\
a_1
\end{array}\right]=\left[\begin{array}{c}
b_0 \\
b_1\\
0
\end{array}\right].\end{equation}
Der Pol in der letzten Gleichung 
\begin{equation}
x(2)+a_1 x(1)=0
\end{equation}
kann damit berechnet werden.
Eingesetzt und nach $a_1$ aufgelöst erhalten wir
\begin{equation}
a_1=-\frac{x(2)}{x(1)}=
-\frac{0.75}{1.5}=
-0.5.
\end{equation}
Mit den bekannten Polen können nun die Nullstellen mit den oberen zwei Gleichungen 
\begin{equation}\left[\begin{array}{c}
b_0 \\
b_1
\end{array}\right]=\left[\begin{array}{cc}
1 & 0 \\
1.5 & 1
\end{array}\right]\left[\begin{array}{c}
1 \\
-0.5
\end{array}\right]=\left[\begin{array}{l}
1 \\
1
\end{array}\right]\end{equation}
berechnet werden.
Die Koeffizienten können nun in das Modell eingesetzt werden, womit wir
\begin{equation}
H(z)=\frac{1+z^{-1}}{1-0.5 z^{-1}}
\end{equation}
erhalten.
Dieses Modell hat eine identische Impulsantwort 
\begin{equation}
h(n)=(0.5)^{n} u(n)+(0.5)^{n-1} u(n-1)
=
\delta(n)+1.5(0.5)^{n-1} u(n-1)\end{equation}
wie $x(n)$.
Erkennbar wenn man $n=0$ bis $n=5$ in $h(n)$ einsetzt.
\begin{align*}
h(0)&=\delta(0)+1.5(0.5)^{0-1} u(0-1)=1\\
h(1)&=\delta(1)+1.5(0.5)^{1-1} u(1-1)=1.5\\
h(2)&=\delta(2)+1.5(0.5)^{2-1} u(2-1)=0.75\\
h(3)&=\delta(3)+1.5(0.5)^{3-1} u(3-1)=0.375\\
h(4)&=\delta(4)+1.5(0.5)^{4-1} u(4-1)=0.1875\\
h(5)&=\delta(5)+1.5(0.5)^{5-1} u(5-1)=0.09375
\end{align*}
Im Vergleich noch einmal $\bm x$ welches Padé-Approximiert wurde
\begin{equation*}
\bm x=[1.0000 , 1.5000, 0.7500 , 0.3750 , 0.1875, 0.0938]^{T}.
\end{equation*}
Dies ist jedoch ein Spezialfall und kommt nicht immer vor.
\qedhere
\end{enumerate}
\end{beispiel}






