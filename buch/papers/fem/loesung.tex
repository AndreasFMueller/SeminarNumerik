%
% loesung.tex -- Beispiel-File für die Beschreibung der Loesung
%
% (c) 2020 Prof Dr Andreas Müller, Hochschule Rapperswil
%
\section{Lösung
\label{fem:section:loesung}}
\rhead{Lösung}

\subsection{Minimalproblem bilden}
Zuerst muss die DGL in ein äqualentes Minimalprobelm übersetzt werden in der Form

Im Gegensatz zu den finiten Elementen im 1 dimensionalen Raum muss bei der Bildung der abgeschwächten Form bzw. in der Übersetzung in das Minimalproblem der Fakt des höheren Dimension mitberücksichtigt werden. Daher wird anstatt der Form für den 1 dimensionalen Fall

\begin{equation}
			\int_0^1 u \textcolor{red}{'} (x)^2 + \lambda u(x)^2 dx
			\label{fem:Minimal1D}
\end{equation}

die mehrdimensionale Form mit dem Laplace Operator verwendet

\begin{equation}
			\int_{\Omega} (\textcolor{red}{\nabla} u)^2 + \lambda u^2 dx
			\label{fem:Minimal2D}
\end{equation}

Wie zu erkennen ist, wird die Ableitung im 1 Dimensionalen durch einen Laplace Operator ersetzt in der Anwendung in der Ebene.

\subsection{Vorbereitung}

Damit die Integration über das gewählte Flächenelement Dreieck oder Parallelogramm einfacher fällt, wird als Vorbereitung im entsprechenden Fall das gewählte Flächenelement in ein Einheitsdreieck oder in ein Eineheitsparallelogramm transformiert. 

Das Allgemeine Dreieck mit den Eckpunkten $P_1(x_1, y_1$),$ P_2(x_2, y_2)$ und $P3(x_3,y_3)$ kann mit Hilfe der linearen Transformation:

\begin{equation}
			x = x_1 + (x_2 - x_1)\xi + (x_3 - X_1)\eta
			y = y_1 + (y_2 - y_1)\xi + (y_3 - y_1)\eta
			\label{fem:linTransformation}
\end{equation}

auf das gleichschenklig rechtwinklige Einheitsdreieck mit Kathetenlänge 1 überführt werden.

\begin{equation}
			J = \left[ \begin{array}{rr}
\frac{\partial x}{\partial \xi} & \frac{\partial y}{\partial \xi}  \\
\frac{\partial x}{\partial \eta} & \frac{\partial y}{\partial \eta}  \\
\end{array}\right] 
			\label{fem:JocobiDeterminante}
\end{equation}

\begin{equation}
			dy dy = J d\xi d\eta
			\label{fem:newTransformation}
\end{equation}

\begin{equation}
			\xi_x = \frac{y_3 - y_1}{J}, \eta_x = -\frac{y_2 - y_1}{J}
			\label{fem:newKoordinate}
\end{equation}



\subsection{Ansatzfunktionen wählen}

Als Ansatzfunktionen stehen diverse Standard- Funktionen in der Ebene zur Verfügung. Sie reichen von einfacheren linearen Termen bishinzu quadratischen. Es kann in der ebene sowohl mit Dreicecken als auch mit Rechtecken gearbeitet werden. Die Wahl der Ansatzfunktionen bzw. der Flächen- Elementen sollte so erfolgen, dass diese die zu approximierende Fläche möglichst gut nachbildet.

In einem ersten Schritt wird die lineare Ansatzfunktionen mit Einheitsdreiecken angewendet.


\subsubsection{linearer Ansatzfunktion mit Dreiecken
\label{fem:subsection:bonorum}}

Die lineare Ansatzfunktion wir gemäss folgender Formel angewendet bzw verwendet.

\begin{equation}
u(x,y) = c_1 + c_2x + c_3y
\label{fem:equationSchwarzLinear}
\end{equation}

Die Formel xXx kann einfach in das Minimalproblem xXx eingesetzt werden.

Das Minimalproblem beinhaltet jedoch noch nicht fir Formfunktion. Diese wird in das Gebietsintegral des Minimalproblem eingesetzt sprich $\int_{\Omega}$ wird durch das folgende Einheitsdreieck Flächenelement ersetzt.

\begin{equation}
\int_a^b \int_c^{d-(d-c)(x-a)/(b-a)} f(x,y) dx dy
\label{fem:FlaecheDreieck}
\end{equation}

Das Einsetzung des linearen Ansatzes und des gewählten Flächenelements haben dann die Form

\begin{equation}
\int_a^b \int_c^{d-(d-c)(x-a)/(b-a)} c_1 + c_2x + c_3y dx dy
\label{fem:MinimalproblemElement}
\end{equation}

Wichtig zu verstehen ist, dass dieses Minimalproblem auf jedes Flächenelement angewendet wird. Als Beispiel kann vorgestellt werden, dass wenn ein Dreieck mit 2 Dreiecken aproxximiert wird, das Minimalproblem \ref{fem:MinimalproblemElement} auf jedes der beiden Dreiecke angewendet wird.

\subsubsection{linearer Ansatzfunktion mit Parallelogramm
\label{fem:subsection:lineParallel}}

\begin{equation}
	u(x,y) = c_1 + c_2 x + c_3 y + c_4 xy
\end{equation} 


%\begin{equation}
%c_i= \int_{\triangle i} (\nabla u)^2 +\lambda u^2 dx
%\label{fem:equation3}
%\end{equation}

%oder\\
%mit einem Allgemeinen Dreieck:

%\begin{equation}
%N(x,y) = \int_a^b\int_c^{d-(d-c)(x-a)/(b-a)} u(x,y) dxdy
%\label{fem:Dreieck_alg}
%\end{equation}

Gemäss Abschnitt 2.2.2 Buch von Schwarz sind die Werte entlang einer Seite eines Dreiecks- Elements gleich  der angrenzenden Linie eines anderen Dreiecks, wenn die Eckpunktwerte gleich sind. Die Frage Warum soll dass so sein? Weil Funktion $h(x)$ bei jedem Element gleich ist sowie es sich bei $h(x)$ hierbei um eine Lineare Funktion handelt.

\subsubsection{Quadratischer Ansatz
\label{fem:subsection:bonorum}}

\begin{equation}
	u(x,y) = c_1 + c_2 x + c_3 y + c_4 x^2 + c_5 xy + c_6 y^2
	\label{fem:equationSchwarzquadratischD}
\end{equation}

\begin{equation}
	u(x,y) = c_1 + c_2 x + c_3 y + c_4 x^2 + c_5 xy + c_6 y^2 + c_7 x^2y + c_8 xy^2
	\label{fem:equationSchwarzquadratischP}
\end{equation} 

\subsection{Aufstellung der Matrix
\label{fem:subsection:goon}}

\begin{equation}
	\nabla u = 	
	\left[ \begin{array}{r}
	\frac{\partial x}{\partial u}  \\
	\frac{\partial x}{\partial y}   \\
	\end{array}\right]
	\label{fem:equationSchwarzquadratischP}
\end{equation} 


