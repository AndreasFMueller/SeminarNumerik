
%
% rationalezahlen.tex -- 
%
% (c) 2020 Benjamin Bouhars-Keller
%
\section{Rationale Zahlen
\label{kettenbruch:section:Zahlen}}
\rhead{Rationale Zahlen}
\subsection{Endliche Kettenbrüche}
Die Menge aller rationalen Zahlen wird mit $\mathbb{Q}$ bezeichnet.
Ein endlicher Kettenbruch ist ein Bruch der Form
\begin{equation}
a_0 + \cfrac{b_1}{a_1+\cfrac{b_2}{a_2+\cfrac{\cdots}{\cdots+\cfrac{b_{n-1}}{a_{n-1} + \cfrac{b_n}{a_n}}}}}
\end{equation}
in welchem $a_0, a_1,\dots,a_n$ und $b_1,b_2,\dots,b_n$ ganze Zahlen
darstellen, die mit Ausnahme möglicherweise von $a_0$ alle positiv sind.
Die Kettenbruchentwicklung von $x \in \mathbb{R}$ bricht genau dann
nach endlich vielen Schritten ab, wenn $x$ rational ist. So bilden
rationale Zahlen endliche Kettenbrüche.

\subsection{Euklidischer Algorithmus}
Die Umwandlung einer rationalen Zahl in einen Kettenbruch erfolgt
mit Hilfe des euklidischen Algorithmus.
Jede rationale Zahl $x$ lässt sich auf eindeutige Weise in einen
endlichen Kettenbruch entwicklen, dessen letzer Teilnenner grösser
oder gleich 2 ist.
\begin{beispiel}
Als Beispiel bestimmen wir den Kettenbruch von $\frac{17}{10} = [1;1,2,3]$:
\begin{equation}
\frac{17}{10}
=
1 + \frac{7}{10}
=
1 + \cfrac{1}{\cfrac{10}{7}}
=
1 + \cfrac{1}{1+\cfrac{3}{7}}
=
1 + \cfrac{1}{1+\cfrac{1}{1+\cfrac{1}{\cfrac{7}{3}}}}
=
1 + \cfrac{1}{1+\cfrac{1}{2+\cfrac{1}{3}}}
\end{equation}
\begin{align*}
17 &= 1\cdot 10 + 7 \\
10 &= 1\cdot 7 + 3 \\
7 &= 2\cdot 3 + 1 \\
3 &= 3\cdot 1 + 0
\end{align*}
Diese Methode kann auch umgekehrt angewendet werden.
Berechnen wir nun den Kettenbruch in einem Bruch zurück.
\begin{align*}
[1;1,2,3] 	
&\rightarrow 	2 + \frac{1}{3} = \frac{7}{3} \\
&\rightarrow 	1 + \frac{3}{7} = \frac{10}{7} \\
&\rightarrow 	1 + \frac{7}{10} = \frac{17}{0} 
\qedhere
\end{align*}
\end{beispiel}
Wie man im Beispiel sieht, ist die intuitive Berechnung der
Näherungsbrüche eines Kettenbruchs, indem man ihn von unten her
auflöst, sehr umständlich. Durch ein rekursives Bildungsgesetz für
Zähler und Nenner kann man die Berechnung erheblich vereinfachen.
Ausserdem kann man mit Hilfe dieser Rekursionsformel die Grenzwerte
unendlicher Kettenbrüche untersuchen.

\subsection{Rekursionsformel}
Die Berechnung der Konvergenten (siehe
Abschnitt~\ref{kettenbruch:nichtperiodisch}) eines Kettenbruches 
kann erheblich vereinfacht werden, indem eine Rekursionsformeln für den Zähler 
und den Nenner eingeführt wird.
Anders formuliert können Grenzwerte für unendliche 
Zahlen oder Funktionen mit Hilfe der Rekursionsformel schneller definiert
werden.

Betrachten wir zunächst die folgende Näherungsbrüche:

\begin{align*}
a_0 + \frac{b_1}{a_1} , a_0 + \cfrac{b_1}{a_1 + \cfrac{b_2}{a_2}} , \cdots
\end{align*}
Wie in Abschnitt 17.1.1 erwähnt wird hier der Nenner wieder als Kettenbruch dargestellt.
Insofern  werden Terme der Form
\begin{align*}
a_k + \cfrac{b_{k + 1}}{a_{k + 1} + \cfrac{p}{q}}
\end{align*}
immer zu
\begin{align*}
\cfrac{b_{k+1}}{a_{k+1} + \cfrac{p}{q}} = \frac{b_{k+1} \cdot q}{a_{k+1} \cdot q + p}
\end{align*}
ausgerechnet.
Dies lässt sich auch durch die folgende Matrizenschreibweise ausdrücken:
\begin{equation}
		\begin{pmatrix}
			\textrm{neuer Zähler}\\
			\textrm{neuer Nenner}
		\end{pmatrix}
 = 		\begin{pmatrix}
			b_{k+1} \cdot q\\
			a_{k+1} \cdot q + p
		\end{pmatrix}
		=\begin{pmatrix}
			0&	b_{k+1}\\
			1&	a_{k+1}
		\end{pmatrix}
		\begin{pmatrix}
		p \\
		q
		\end{pmatrix}.
\label{kettenbruch:section:Rekursionsformel}
\end{equation}
Der ``unterste'' Bruch ist $\frac{b_n}{a_n}$, also in Vektorschreibweise
\begin{align*}
a_0 + 	\begin{pmatrix}
			0& b_1\\
			1& a_1
		\end{pmatrix}
		\cdots
		\begin{pmatrix}
			0& b_{n-1}\\
			1& a_{n-1}
		\end{pmatrix}
		\begin{pmatrix}
			b_n\\
			a_n
		\end{pmatrix}
\qquad\textrm{Aufbau ``von rechts nach links''.}
\end{align*}
Aber das Matrizenprodukt kann man auch von links beginnend ausmultiplizieren als
\begin{align*}
		\begin{pmatrix}
			0& b_1\\
			1& a_1
		\end{pmatrix}
		\cdots
		\begin{pmatrix}
			0& b_{n-1}\\
			1& a_{n-1}
		\end{pmatrix}
		\begin{pmatrix}
			b_n\\
			a_n
		\end{pmatrix},
\end{align*}
d.h. man kann bei $b_1, a_1$ beginnen, dies wird weiter unten im Detail
ausgeführt.

Man kann die beiden Schritte
\begin{align*}
\frac{p}{q} \rightarrow a_k + \frac{p}{q} \rightarrow \cfrac{b_k}{a_k + \cfrac{p}{q}}
\end{align*}
auch separat als Matrizen schreiben.
\begin{align*}
a_k + \frac{p}{q} &= \frac{a_k \cdot q + p}{q} &&\text{d.~h.} &&
	\begin{pmatrix}
		1& a_k\\
		0& 1
	\end{pmatrix}
	\begin{pmatrix}
		p\\
		q
	\end{pmatrix}
\\
\cfrac{b_k}{\frac{p}{q}} &= \frac{b_k \cdot q}{p} &&\text{d.~h.} &&
	\begin{pmatrix}
		1& b_k\\
		0& 1
	\end{pmatrix}
	\begin{pmatrix}
		p\\
		q
	\end{pmatrix}.
\end{align*}
Tatsächlich ist die Kombination der beiden Schritte
\begin{align*}
		\begin{pmatrix}
			0& b_n\\
			1& 0
		\end{pmatrix}
		\begin{pmatrix}
			1& a_n\\
			0& 1
		\end{pmatrix}
	=	\begin{pmatrix}
			0& b_n\\
			1& a_n
		\end{pmatrix}
\end{align*}
wie in \eqref{kettenbruch:section:Rekursionsformel}  gefunden.
\subsubsection {Aufbau des von links nach rechts}
Das Produkt von Matrizen kann man auch von links her ausmultiplizieren.
\begin{align*}
		\begin{pmatrix}
			1& a_0\\
			0& 1
		\end{pmatrix}
		\begin{pmatrix}
			0& b_1\\
			1& a_1
		\end{pmatrix}
		\begin{pmatrix}
			0& b_2\\
			1& a_2
		\end{pmatrix}
		\cdots
		\begin{pmatrix}
			0& b_{n-1}\\
			1& a_{n-1}
		\end{pmatrix}
		\begin{pmatrix}
			b_n\\
			a_n
		\end{pmatrix}
\end{align*}
\begin{itemize}
\item Start:
\begin{equation*}
		\begin{pmatrix}
			1& a_0\\
			0& 1
		\end{pmatrix}
	=	\begin{pmatrix}
			A_{-1}& A_0\\
			B_{-1}& B_0
		\end{pmatrix}
	=	P_0
\end{equation*}
\item Schritt 1: von rechts mit nächsten Matrixfaktor multiplizieren
\begin{equation*}
		\begin{pmatrix}
			1& a_0\\
			0& 1
		\end{pmatrix}
		\begin{pmatrix}
			1& b_1\\
			0& a_1
		\end{pmatrix}
	=	\begin{pmatrix}
			a_0& b_1 + a_0 \cdot a_1\\
			1&	a_1
		\end{pmatrix}
	=	\begin{pmatrix}
			A_{-1}& A_0\\
			B_{-1}& B_0
		\end{pmatrix}
		\begin{pmatrix}
			1& b_1\\
			0& a_1
		\end{pmatrix}
	=	\begin{pmatrix}
			A_0& A_1\\
			B_0& B_1
		\end{pmatrix}
	=	P_1
\end{equation*}
\item Schritt 2:
\begin{equation*}
P_1 \cdot	\begin{pmatrix}
				0& b_2\\
				1& a_2
			\end{pmatrix}
		=	\begin{pmatrix}
				A_0& A_1\\
				B_0& B_1
			\end{pmatrix}
			\begin{pmatrix}
				0& b_2\\
				1& a_2
			\end{pmatrix}
		=	\begin{pmatrix}
				A_1& b_2 \cdot A_0 + a_2 \cdot A_1\\
				B_1& b_2 \cdot B_0 + a_2 \cdot B_1
			\end{pmatrix}
		= 	P_2
\end{equation*}
\item Schritt 3:
\begin{equation*}
P_2 \cdot	\begin{pmatrix}
				0& b_3\\
				1& a_3
			\end{pmatrix}
		=	\begin{pmatrix}
				A_1& A_2\\
				B_1& B_2
			\end{pmatrix}
			\begin{pmatrix}
				0& b_3\\
				1& a_3
			\end{pmatrix}
		=	\begin{pmatrix}
				A_2& b_3 \cdot A_1 + a_3 \cdot A_2\\
				B_2& b_3 \cdot B_1 + a_3 \cdot B_2
			\end{pmatrix}
		= 	P_2 \qquad \text{liefert.}
\end{equation*}
\item Schritt $n-1$:
So macht man weiter bis zum Schritt $n-1$, der die Matrix
\begin{equation*}
P_{n-1} = 	\begin{pmatrix}
				A_{n-2}& A_{n-1}\\
				B_{n-2}& B_{n-1}			
			\end{pmatrix}
\end{equation*}
liefert.
\item Schritt $n$:
Zähler und Nenner des Näherungsbruchs bekommt man jetzt durch Multiplikation
mit 
\[
\begin{pmatrix}
b_n\\
a_n
\end{pmatrix}.
\]
Dies ist aber die zweite Spalte der Matrix
\[
\begin{pmatrix}
0& b_n\\
1& a_n
\end{pmatrix},
\]
d.~h.~Zähler und Nenner stehen in der zweite Spalte von $P_n$.
\end{itemize}

\subsubsection{Rekursionsformeln für $A_n$ und $B_n$}
Wir möchten jetzt Formeln für die Berechnung von Zähler $A_n$ und Nenner $B_n$
des Wertes
\begin{align*}
\frac{A_n}{B_n}
=
a_0 + \cfrac{b_1}{a_1+\cfrac{b_2}{a_2+\cfrac{\cdots}{\cdots+\cfrac{b_{n-1}}{a_{n-1} + \cfrac{b_n}{a_n}}}}}
\end{align*}
des $n$-ten Näherungsbruches bekommen.
Die Berechnung von $A_n, B_n$ kann man auch ohne die Matrizenschreibweise
aufschreiben:
\begin{itemize}
\item Start:
\begin{align*}
A_{-1} &= 0		&		A_0 &= a_0 \\
B_{-1} &= 1		&		B_0 &= 1 
\end{align*}
$\rightarrow$ 0-te Näherung: $\displaystyle\frac{A_0}{B_0} = a_0$
\item Schritt $k\to k+1$:
\begin{align*}
k &\rightarrow k + 1
&
A_{k+1} &= A_{k-1} \cdot b_k + A_k \cdot a_k \\
&&
B_{k+1} &= B_{k-1} \cdot b_k + B_k \cdot a_k
\end{align*}
\item
Näherungsbruch $n$: \qquad$\displaystyle\frac{A_n}{B_n}$
\end{itemize}
\subsubsection{Einfache Kettenbrüche}
Schliesslich sind für reguläre oder einfache Kettenbrüche die Formeln
einfacher, weil $b_k = 1$.
Es gilt
\begin{align*}
A_{k+1} &= A_{k-1} + A_k \cdot a_k \\
B_{k+1} &= B_{k-1} + B_k \cdot a_k.
\end{align*}
Hiermit haben wir die wichtigsten Zusammenhänge als Vorbereitung für die Näherungszahlen herausgearbeitet.
